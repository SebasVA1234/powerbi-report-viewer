#windows-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: calc(100% - 48px);
    pointer-events: none;
    z-index: 1000;
}

.report-window {
    position: absolute;
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    pointer-events: auto;
    transition: box-shadow 0.2s ease, transform 0.2s ease, opacity 0.2s ease;
    min-width: 400px;
    min-height: 300px;
}

.report-window.active { box-shadow: 0 12px 48px rgba(0, 0, 0, 0.2); }
.report-window.dragging { opacity: 0.9; cursor: grabbing; }
.report-window.minimized { transform: scale(0) translateY(100%); opacity: 0; pointer-events: none; }
.report-window.maximized { left: 0 !important; top: 0 !important; width: 100% !important; height: calc(100vh - 48px) !important; border-radius: 0; }
.report-window.closing { transform: scale(0.8); opacity: 0; }

.window-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
    color: white;
    cursor: grab;
    user-select: none;
}

.window-title { display: flex; align-items: center; gap: 8px; flex: 1; min-width: 0; }
.window-icon { width: 18px; height: 18px; }
.window-title-text { font-size: 14px; font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

.window-controls { display: flex; gap: 4px; }
.window-btn { width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border: none; background: rgba(255,255,255,0.1); color: white; border-radius: 6px; cursor: pointer; transition: all 0.15s ease; }
.window-btn svg { width: 14px; height: 14px; }
.window-btn:hover { background: rgba(255,255,255,0.2); }
.window-btn-close:hover { background: #ef4444; }

.window-body { flex: 1; position: relative; background: #f5f5f5; overflow: hidden; }
.window-loading { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; background: #f8f9fa; gap: 16px; color: #666; z-index: 10; }
.loading-spinner { width: 40px; height: 40px; border: 3px solid #e5e7eb; border-top-color: #6366f1; border-radius: 50%; animation: spin 0.8s linear infinite; }
@keyframes spin { to { transform: rotate(360deg); } }
.window-iframe { width: 100%; height: 100%; border: none; }

.window-resize-handle { position: absolute; bottom: 0; right: 0; width: 20px; height: 20px; cursor: nwse-resize; background: linear-gradient(135deg, transparent 50%, rgba(99,102,241,0.3) 50%); }
.report-window.maximized .window-resize-handle { display: none; }

#taskbar {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: 48px;
    background: linear-gradient(180deg, #1e1e2e 0%, #181825 100%);
    border-top: 1px solid rgba(255,255,255,0.1);
    display: none;
    align-items: center;
    justify-content: space-between;
    padding: 0 16px;
    z-index: 2000;
}

body.has-taskbar #taskbar { display: flex; }
body.has-taskbar #dashboard-page .app-layout { height: calc(100vh - 48px); }

.taskbar-windows { display: flex; gap: 8px; flex: 1; overflow-x: auto; }
.taskbar-btn { display: flex; align-items: center; gap: 8px; padding: 6px 12px; background: rgba(255,255,255,0.08); border: 1px solid transparent; border-radius: 6px; color: rgba(255,255,255,0.8); cursor: pointer; max-width: 200px; min-width: 120px; }
.taskbar-btn:hover { background: rgba(255,255,255,0.12); color: white; }
.taskbar-btn.focused { background: rgba(99,102,241,0.4); border-color: #6366f1; color: white; }
.taskbar-btn.minimized { background: rgba(255,255,255,0.05); color: rgba(255,255,255,0.5); border-style: dashed; border-color: rgba(255,255,255,0.2); }
.taskbar-btn-icon { width: 16px; height: 16px; }
.taskbar-btn-title { font-size: 12px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

.taskbar-info { display: flex; align-items: center; padding-left: 16px; border-left: 1px solid rgba(255,255,255,0.1); margin-left: 16px; }
.window-count { font-size: 12px; color: rgba(255,255,255,0.6); }